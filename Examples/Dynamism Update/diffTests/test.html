<div id="first">
    <p>Selamlar</p>
    <p>Selamlar</p>
</div>
<hr>
<div id="second">
<h2 classx="Dünya">Hello World <span>.</span></h2>
</div>
<hr>
<div id="third">
<h2 classx="Merhaba">Hello World <span>.</span></h2>
</div>


<script>
    let first=document.querySelector("#first")
    let second=document.querySelector("#second")

    const diff=(first,second)=>{
        if(!first.isEqualNode(second)){
            let firstArray=Array.from(first.childNodes);
            let firstLength=firstArray.length;
            let secondArray=Array.from(second.childNodes);
            let secondLength=secondArray.length;
            let differencies=Math.abs(firstLength-secondLength)
            if(differencies){
                if(firstLength>secondLength){
                    //remove
                    while(differencies>0){
                        if(!first.isEqualNode(second)){
                        first.children[Array.from(first.children).length-1].remove()
                        }
                        differencies--
                    }
                    diff(first,second)
                }else if(secondLength>firstLength){
                    //push
                    while(differencies>0){
                        if(!first.isEqualNode(second)){
                        first.append(secondArray[secondArray.length - 1].cloneNode(true))
                        secondArray.pop();
                        }
                        differencies--
                    }
                    diff(first,second)
                }
            }else{
                firstArray.forEach((e,index)=>{
                    if(!e.isEqualNode(secondArray[index])){
                        if(e.nodeType==3&&secondArray[index].nodeType==3){
                            if(e.textContent!=secondArray[index].textContent){
                                e.nodeValue=secondArray[index].textContent;
                            }
                        }else{
                            if(e.nodeType!=secondArray[index].nodeType){
                                e.replaceWith(secondArray[index].cloneNode(true))
                            }else{
                                if(e.nodeName!=secondArray[index].nodeName){
                                    e.replaceWith(secondArray[index].cloneNode(true))
                                }else{
                                    //Attributeler farklı olabilir!
                                    //attributeler değişmesine rağmen aynı değilse diff açılır!
                                    //class diffing eklenecek ekle çıkar işlemleri
                                    //attributeler için diffing
                                    if(e.nodeType==1&&secondArray[index].nodeType==1){
                                        let firstNames=e.getAttributeNames()
                                        let secondNames=secondArray[index].getAttributeNames();

                                            secondNames.forEach((attr,ind)=>{
                                                //class için olaylar farklı
                                                if(attr!="class"){
                                                    if(e.getAttribute(attr)!=secondArray[index].getAttribute(attr)){
                                                        e.setAttribute(attr,secondArray[index].getAttribute(attr))
                                                        console.log(e,secondArray[index])
                                                    }
                                                }
                                            })

                                    }   

                                    
                                    if(!e.isEqualNode(secondArray[index])){
                                        diff(e,secondArray[index])//ikisinden biri doğru
                                        //e.replaceWith(secondArray[index].cloneNode(true))
                                    }
                                }
                            }

                        }
                    }
                })
            }
        }
    }

setTimeout(()=>{
    diff(first,second);
    setTimeout(()=>{
        diff(first,third)
    },4000)
},4000)

</script>