<div id="first">
    <p>Selamlar</p>
    <p>Selamlar</p>
</div>
<hr>
<div id="second">
<h2 class="selam">Hello World <span>.</span></h2>
</div>
<hr>
<div id="third">
<h2 class="Merhaba" x="ss">Hello World <span>.</span></h2>
</div>


<script>
    let first=document.querySelector("#first")
    let second=document.querySelector("#second")

    const classDiff=(st,nd)=>{
        let first=[...st.classList]
        let second=[...nd.classList]
        let classDiffNumber=Math.abs(first.length-second.length)

        console.log(classDiffNumber)
        if(!classDiffNumber){
            second.forEach((cls,inde)=>{
                
            })
        }else{
            //add or remove
        }

    }

    const diff=(first,second,tested)=>{
        if(!first.isEqualNode(second)){
            let firstArray=Array.from(first.childNodes);
            let firstLength=firstArray.length;
            let secondArray=Array.from(second.childNodes);
            let secondLength=secondArray.length;
            let differencies=Math.abs(firstLength-secondLength)
            if(differencies){
                if(firstLength>secondLength){
                    //remove
                    while(differencies>0){
                        if(!first.isEqualNode(second)){
                        first.children[Array.from(first.children).length-1].remove()
                        }
                        differencies--
                    }
                    diff(first,second)
                }else if(secondLength>firstLength){
                    //push
                    while(differencies>0){
                        if(!first.isEqualNode(second)){
                        first.append(secondArray[secondArray.length - 1].cloneNode(true))
                        secondArray.pop();
                        }
                        differencies--
                    }
                    diff(first,second)
                }
            }else{
                firstArray.forEach((e,index)=>{
                    if(!e.isEqualNode(secondArray[index])){
                        if(e.nodeType==3&&secondArray[index].nodeType==3){
                            if(e.textContent!=secondArray[index].textContent){
                                e.nodeValue=secondArray[index].textContent;
                            }
                        }else{
                            if(e.nodeType!=secondArray[index].nodeType){
                                e.replaceWith(secondArray[index].cloneNode(true))
                            }else{
                                if(e.nodeName!=secondArray[index].nodeName){
                                    e.replaceWith(secondArray[index].cloneNode(true))
                                }else{
                                    //Attributeler farklı olabilir!
                                    //attributeler değişmesine rağmen aynı değilse diff açılır!
                                    //class diffing eklenecek ekle çıkar işlemleri
                                    //attributeler için diffing
                                    if(e.nodeType==1&&secondArray[index].nodeType==1){
                                        let firstNames=e.getAttributeNames()
                                        let secondNames=secondArray[index].getAttributeNames();
                                        let diffAttrNumber=Math.abs(firstNames.length-secondNames.length)
                                            if(secondNames.length==firstNames.length){
                                                secondNames.forEach((attr,ind)=>{
                                                //class için olaylar farklı
                                                if(attr!="class"){
                                                    if(e.getAttribute(attr)!=secondArray[index].getAttribute(attr)){
                                                        e.setAttribute(attr,secondArray[index].getAttribute(attr))
                                                    }
                                                }else{
                                                    classDiff(e,secondArray[index])
                                                }
                                            })
                                        }else{
                                            //attribute ekle çıkar işlemleri
                                                if (firstNames.length > secondNames.length) {
                                                    //removeattribute
                                                            let differentAttrs=firstNames.filter((attribute)=>{
                                                                return !secondNames.includes(attribute)
                                                            })
                                                            if(differentAttrs.length){
                                                                differentAttrs.forEach((diffed)=>{
                                                                e.removeAttribute(diffed)
                                                                })
                                                            }
                                                            let sameAttrs=firstNames.filter((attribute)=>{
                                                                return secondNames.includes(attribute)
                                                            })
                                                            if(sameAttrs.length){
                                                                sameAttrs.forEach((k,jndex)=>{
                                                                if(e.getAttribute(k)!=secondArray[index].getAttribute(k)){
                                                                    if(k!="class"){
                                                                        e.setAttribute(k,secondArray[index].getAttribute(k))
                                                                    }else{
                                                                        classDiff(e,secondArray[index])
                                                                    }

                                                                }
                                                            })
                                                            }
                                                    diff(e, secondArray[index])
                                                } else if (secondNames.length > firstNames.length) {
                                                    //addAttr
                                                        if (!e.isEqualNode(secondArray[index])) {
                                                            let differentAttrs=secondNames.filter((attribute)=>{
                                                                return !firstNames.includes(attribute)
                                                            })
                                                            if(differentAttrs.length){
                                                                differentAttrs.forEach((diffed)=>{
                                                                e.setAttribute(diffed,secondArray[index].getAttribute(diffed))
                                                                })
                                                            }
                                                            let sameAttrs=secondNames.filter((attribute)=>{
                                                                return firstNames.includes(attribute)
                                                            })
                                                            if(sameAttrs){
                                                                sameAttrs.forEach((k,jndex)=>{
                                                                if(e.getAttribute(k)!=secondArray[index].getAttribute(k)){
                                                                    if(k!="class"){
                                                                        e.setAttribute(k,secondArray[index].getAttribute(k))
                                                                    }else{
                                                                        classDiff(e,secondArray[index])
                                                                    }   
                                                                }
                                                            })
                                                            }
                                                        }
                                                    diff(e, secondArray[index])
                                                }
                                        }
                                    }

                                    if(!e.isEqualNode(secondArray[index])){
                                        diff(e,secondArray[index],true)//ikisinden biri doğru
                                    }

                                    //confirm
                                    if(tested){
                                        e.replaceWith(secondArray[index])
                                    }
                                }
                            }

                        }
                    }
                })
            }
        }
    }

setInterval(()=>{
    diff(first,second);
    setTimeout(()=>{
        diff(first,third)
    },1000)
},2000)

</script>

<style>
    body{
        transition: 1s;
    }
    .selam{
        background-color: blueviolet;
    }
</style>