const updatedEvent=new Event("updated");let mountEv=new Event("mount");const Anchor={replacer:function(e){let t=e;return t=(t=(t=(t=(t=(t=t.replace("<>","<div>").replace("</>","</div>")).replaceAll("[-","<span delete='").replaceAll("-]","'></span>")).replaceAll("[[","mark='").replaceAll("]]","'")).replaceAll("[{","<span anchor='").replaceAll("}]","'></span>")).replaceAll("{{","<span state='").replaceAll("}}","'></span>")).replaceAll("{(","<span tnode='").replaceAll(")}","'></span>"),t=this.namer(t)},namer(e){let t=e,n=t.split("/>").length-1,o=0;for(;n>o;){let l=t.search("/>")-1,r=0,s="";for(;l-r>=-1;){if("<"==t.charAt(l-r)){let i=(s=s.split("").reverse().join("")).split(" ")[0],a,c=`<${i} ${s.replace(i,"")||""}></${i}>`;t=t.slice(0,l-r)+c+t.slice(l+3,t.length),o++,l="",r=0,s=""}else s+=t.charAt(l-r);r++}}return t},rkg(){let e="",t="abcdefghijklmnoprstuxvyz_".split("");for(var n=0;n<=9;n++)e+=t[Math.floor(24*Math.random())];return e},registeredComponents:new Map};document.addEventListener("mount",()=>{Anchor.registeredComponents.forEach((e,t)=>{let n=document.querySelectorAll(t);n.length>0&&n.render(e)})});const RegisterComponent=(e,t)=>{Anchor.registeredComponents.set(e,t)};function html(e,...t){let n={nodeLists:[],onEffect:null,onUnmount:null,onMount:null,onSignal:null,active:!0,memo:!1,mounted:!1,rate:30,childComponents:[],key:Anchor.rkg(),target:null},o=[],l=[...t];e.forEach((e,t)=>{o.push(e),void 0!=l[t]&&o.push(l[t])});let r=document.createElement("template"),s="";o.forEach(e=>{"string"==typeof e?s+=e:s+='<span class="achrplcelem"></span>'}),s=Anchor.replacer(s),r.innerHTML=s;let i=r.content,a=e=>{if(!0==n.active){let t=!1;n.nodeLists.forEach(e=>{let o=e.func();e.before!=o&&(e.node.nodeValue=o,e.before=o,"function"==typeof n.onEffect&&(t=!0),i.dispatchEvent(updatedEvent))}),t&&n.onEffect(e),n.childComponents.length>0&&"local"!=e&&n.childComponents.forEach(t=>{!1==t.details.memo&&"HTML"!==t.type&&t.effect(e)})}c(e)},c=e=>{n.onSignal&&n.mounted&&n.onSignal(e)},d=()=>{!1==n.mounted&&(n.mounted=!0,n.onMount&&n.onMount(),document.dispatchEvent(mountEv))},u=debounce(()=>{a()},()=>n.rate),p=debounce(()=>{a("local")},()=>n.rate);[...t].forEach(e=>{if("object"==typeof e||"number"==typeof e){if(Object.keys(e).length>0){if("For"==e.type)i.querySelector(".achrplcelem").replaceWith(e.fragment),e.setParent(a);else if(e.content){let t=e;i.querySelector(".achrplcelem").replaceWith(t.content),n.childComponents.push(t),t.mount(),document.dispatchEvent(mountEv,t)}else i.querySelector(".achrplcelem").replaceWith(e)}else i.querySelector(".achrplcelem").replaceWith(e)}else if("function"==typeof e){let c=e();if("object"==typeof c)c.content?(i.querySelector(".achrplcelem").replaceWith(c.content),c.mount&&(n.childComponents.push(c),c.mount()),document.dispatchEvent(mountEv)):i.querySelector(".achrplcelem").replaceWith(c);else if("number"==typeof c||"string"==typeof c){let d=document.createTextNode(c);i.querySelector(".achrplcelem").replaceWith(d),n.nodeLists.push({node:d,func:e,before:c})}}[o,l,r,s]=[null,null,null,null]});let h={},f=e=>{Object.keys(e).forEach(t=>{h[t]=e[t]}),i.querySelectorAll("[state]").forEach(e=>{let t=e.getAttribute("state").split("("),o=t[0],l=null;switch(t.length>1&&(t[1]=t[1].slice(0,-1),l=Function(`return ${l=t[1]}`)()),typeof h[o]){case"number":case"string":let r=document.createTextNode(h[o]);e.replaceWith(r);let s=()=>h[o];n.nodeLists.push({node:r,func:s,before:h[o]});break;case"function":let i=h[o](l),a=document.createTextNode(i??"");e.replaceWith(a);let c=()=>h[o](l);n.nodeLists.push({node:a,func:c,before:i})}}),i.querySelectorAll("*").forEach(e=>{e.getAttributeNames().forEach(t=>{if("@"==t[0]||"$"==t[0]||"_"==t[0]){let n=()=>{switch(t[0]){case"@":i.dispatchEvent(updatedEvent);break;case"$":document.dispatchEvent(updatedEvent)}},o=t.slice(1),l=e.getAttribute(t),r=l.split("("),s=null;switch(r.length>1&&(r[1]=r[1].slice(0,-1),"'"==(s=r[1])[0]&&'"'==s[0]&&"`"==s[0]?s=Function(`return ${s}`)():"$"==s[0]&&(s=Function(`return ${h[s.slice(1)]}`)())),o){case"onclick":case"oninput":case"onchange":case"onmouseover":e[o]=()=>{h[r[0]??l](s??e),n()};break;case"model":"text"==e.type||"textarea"==e.type?e.oninput=()=>{h[l]=e.value,n()}:"checkbox"==e.type&&(e.oninput=()=>{h[l]=e.checked,n()});let a=function(){"text"==e.type||"textarea"==e.type||"checkbox"==e.type?e.value=h[l]:e.textContent=h[l]};i.addEventListener("updated",a),document.addEventListener("updated",a);break;case"class":let c=h[r[0]??l](s);c&&e.classList.add(c);let d=c,u=function(){h[r[0]??l](s)&&e.classList.contains(d)?d!=h[r[0]??l](s)&&(e.classList.remove(d),e.classList.add(h[r[0]??l](s)),d=h[r[0]??l](s)):!h[r[0]??l](s)&&e.classList.contains(d)?e.classList.remove(d):h[r[0]??l](s)&&!e.classList[h[r[0]??l]()]&&(e.classList.add(h[r[0]??l](s)),d=h[r[0]??l](s))};i.addEventListener("updated",u),document.addEventListener("updated",u);case"hide":case"show":{let p=()=>{let t=h[r[0]??l](s??e);"hide"==o&&t||"show"==o&&!t?e.style.display="none":e.style.display=""};i.addEventListener("updated",p),document.addEventListener("updated",p)}break;case"visible":case"invisible":{let f=()=>{let t=h[r[0]??l](s);"invisible"==o&&t||"visible"==o&&!t?e.style.visibility="hidden":e.style.visibility="visible"};i.addEventListener("updated",f),document.addEventListener("updated",f)}break;case"destroy":{let m=function(){h[r[0]??l](s??e)&&(e.remove(),i.removeEventListener("updated",m),n())};i.addEventListener("updated",m),document.addEventListener("updated",m)}break;default:switch(typeof h[r[0]??l]){case"number":case"string":{let y=()=>{e[o]=h[l]};i.addEventListener("updated",y),document.addEventListener("updated",y)}break;case"function":{let E=()=>{e[o]=h[r[0]??l](s)};i.addEventListener("updated",E),document.addEventListener("updated",E)}}}e.removeAttribute(t)}})}),i.dispatchEvent(updatedEvent)},[m,y,E]=[{},{},{}];return $$$_(m,y,E,i),u(),document.addEventListener("updated",()=>u()),i.addEventListener("updated",()=>u()),i.firstElementChild.classList.add(n.key),document.dispatchEvent(updatedEvent),{content:i,datalist:h,details:n,unmount:{callback:null,remove(){unmountCallback=null},callback(){n.childComponents.length>0&&(n.childComponents.forEach(e=>{e.unmount.callback(),e.details.mounted=!1}),document.dispatchEvent(updatedEvent)),n.onUnmount&&n.onUnmount(),n.mounted=!1,n.target=null,n.active=!1}},effect:a,signal:c,mount:d,update:u,localUpdate:p,states:f,$:m,_:E,$$:y}}const GlobalUpdate=()=>{document.dispatchEvent(updatedEvent)},OnGlobalUpdate=e=>{document.addEventListener("updated",e)},HTML=e=>{let t=document.createElement("template"),n="",o="HTML",l=Anchor.rkg(),r={onUnmount:null,onMount:null};e.forEach(e=>n+=e),n=Anchor.replacer(n),n=Anchor.namer(n),t.innerHTML=n;let[s,i,a]=[{},{},{}];$$$_(s,i,a,content);let c=()=>{"function"==typeof r.onMount&&r.onMount(),document.dispatchEvent(mountEv)},d={callback:null,callback(){"function"==typeof r.onUnmount&&r.onUnmount(),document.querySelectorAll("."+l).forEach(e=>e.remove())}};return content.firstElementChild.classList.add(l),{content,$:s,_:a,$$:i,type:o,details:r,mount:c,unmount:d}},simpleFor=function(e,t){let n=e,o=t,l=document.createElement("div"),r=()=>{let e=n.map(o).join("");if(l.innerHTML!=e){let t=HTML(e);l.textContent="",l.append(t)}};return r(),{type:"For",fragment:l,update:r}},core={registeredRenders:[]};if(void 0==window.prototyped){Object.prototype.selectElement=function(e){let t=this.querySelectorAll(e);return 1==t.length?t[0]:t},Object.defineProperty(Object.prototype,"text",{set:function(e){Array.isArray(this)&&"object"==typeof this&&this.length>1?this.forEach(t=>{e=e.toString(),3==t.nodeType?t.textContent!=e&&(t.nodeValue=e):t.textContent!=e&&(t.textContent=e)}):(e=e.toString(),3==this.nodeType?this.textContent!=e&&(this.nodeValue=e):this.textContent!=e&&(this.textContent=e))},get:function(){if(this){let e=[];return this.length>1?(this.forEach(t=>{e.push(t.textContent)}),e):this.textContent}console.warn("Anchors :\nInvalid definition")}}),Object.prototype.render=function(e,t){if("object"==typeof e)this.textContent="",e.content.selectElement("[anchor]").forEach(e=>{e.removeAttribute("anchor")}),this.append(e);else if("function"==typeof e){this.textContent="";let n=e(t);n.content.selectElement("[anchor]").forEach(e=>{e.removeAttribute("anchor")}),this.append(n.content)}},NodeList.prototype.render=function(e,t){this.forEach(n=>{if(n.selectElement("[anchor]").forEach(e=>{e.removeAttribute("anchor")}),n.textContent="","object"==typeof e)n.append(e.cloneNode(!0));else if("function"==typeof e){let o=!1;core.registeredRenders.forEach(e=>e.target[0]==this[0]?o=!0:""),!0==o&&(core.registeredRenders.forEach(e=>{e.target[0]==this[0]&&e.data.unmount.callback()}),core.registeredRenders=core.registeredRenders.filter(e=>e.target[0]!=this[0]));let l=e(t);n.append(l.content),l.details&&"HTML"!==l.type?(l.details.target=this,core.registeredRenders.push({target:this,data:l}),l.mount()):"HTML"===l.type&&l.mount()}})},Object.prototype.slot=function(e){e?this.content.querySelector("slot").replaceWith(e):(console.warn("Anchors Slot Error:\nSlot is not defined"),this.content.querySelectorAll("slot").forEach(e=>e.remove()))},Object.prototype.setRate=function(e){function t(){console.warn("Anchors SetRate Error:\nRate Must Be A 'Whole Number 0,1,2....'")}if("number"==typeof e||"string"==typeof e){if(e>-1){let n=parseInt(e);"number"!=typeof n?t():this.details.rate=n}else t()}},Object.prototype.kill=function(){this.unmount.callback(),document.body.querySelectorAll(`.${this.details.key}`).forEach(e=>{e.remove()}),delete this},Object.prototype.onEffect=function(e){"function"==typeof e?this.details.onEffect=e:this.details.onEffect=null},Object.prototype.onUnmount=function(e){"function"==typeof e?this.details.onUnmount=e:this.details.onUnmount=null},Object.prototype.onMount=function(e){"function"==typeof e?this.details.onMount=e:this.details.onMount=null},Object.prototype.onSignal=function(e){"function"==typeof e?this.details.onSignal=e:this.details.onSignal=null},Object.prototype.memo=function(e){!0==e||void 0==e||null==e?this.details.memo=!0:this.details.memo=!1},Object.prototype.component=function(e,t){this.content.querySelectorAll(e).forEach(e=>{let n=e.getAttributeNames(),o={};n.forEach(t=>{o[t]=e.getAttribute(t)});let l=new DocumentFragment,r=[...e.childNodes];r.forEach(e=>{l.append(e)});let s=t(o,r.length>0?l:void 0);e.replaceWith(s.content),"HTML"!==this.type&&s.mount&&this.details.childComponents.push(s),s.mount()})};let e=(e,t,n)=>{Array.isArray(t)||t.length>1?t.forEach(t=>{t[e]=n}):t[e]=n};Object.defineProperties(Object.prototype,{onClick:{set(t){e("onclick",this,t)}},onInput:{set(t){e("oninput",this,t)}},onChange:{set(t){e("onchange",this,t)}},Hrefs:{set(t){e("href",this,t)}},Srcs:{set(t){e("src",this,t)}},Styles:{set(t){e("style",this,t)}},Values:{set(t){e("value",this,t)}},onMouseOver:{set(t){e("onmouseover",this,t)}},onMouseOut:{set(t){e("onmouseout",this,t)}},onKeyDown:{set(t){e("onkeydown",this,t)}},onKeyUp:{set(t){e("onkeyup",this,t)}},onKeyPress:{set(t){e("onkeypress",this,t)}},onLoad:{set(t){e("onload",this,t)}}})}const debounce=(e,t)=>{let n;return function(){clearTimeout(n),n=setTimeout(()=>e(),t())}};window.prototyped=!0;const $$$_=(e,t,n,o)=>{o.querySelectorAll("[anchor]").forEach(t=>{e[t.getAttribute("anchor")]=t,t.removeAttribute("anchor")}),o.querySelectorAll("[mark]").forEach(e=>{n[e.getAttribute("mark")]=e,e.removeAttribute("mark")}),o.querySelectorAll("[tnode]").forEach(e=>{let n=e.getAttribute("tnode"),o=document.createTextNode("");e.replaceWith(o),t[n]=o}),o.querySelectorAll("[delete]").forEach(e=>{e.remove()})};